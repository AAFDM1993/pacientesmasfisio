<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Cl칤nico Privado</title>
    <style>
        :root { --primary: #2c3e50; --accent: #27ae60; --bg: #f4f7f6; --blue: #3498db; --danger: #e74c3c; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); margin: 0; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        
        /* Pantalla de Login */
        #login-screen { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); text-align: center; width: 300px; }
        #login-screen h1 { font-size: 1.5rem; color: var(--primary); margin-bottom: 20px; }
        #login-screen input { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; text-align: center; font-size: 1.2rem; }
        
        /* Contenedor Principal (Oculto al inicio) */
        #main-app { display: none; width: 100%; max-width: 1200px; margin: 20px; grid-template-columns: 400px 1fr; gap: 20px; align-items: start; }
        
        .panel { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        h2 { font-size: 1.1rem; color: var(--primary); margin: 0 0 15px 0; border-bottom: 2px solid #eee; padding-bottom: 8px; text-transform: uppercase; }

        label { font-size: 0.85rem; font-weight: bold; color: #7f8c8d; }
        input, textarea { width: 100%; padding: 10px; margin: 5px 0 15px 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        
        /* Men칰 de Notas R치pidas */
        .quick-notes { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px; }
        .btn-tag { 
            background: #ebf5fb; border: 1px solid #d6eaf8; color: #2980b9; padding: 8px 4px; 
            border-radius: 4px; font-size: 0.7rem; cursor: pointer; font-weight: bold; text-align: center;
            display: flex; align-items: center; justify-content: center; min-height: 40px;
        }
        .btn-tag:hover { background: #d6eaf8; }
        .btn-tag.long { grid-column: span 2; }

        .btn-save { width: 100%; background: var(--accent); color: white; border: none; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 1rem; }
        .btn-logout { background: var(--danger); color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-size: 0.8rem; float: right; }

        /* Lista de Pacientes */
        .paciente-item { padding: 12px; border-bottom: 1px solid #eee; cursor: pointer; border-radius: 4px; display: flex; flex-direction: column; }
        .paciente-item.active { background: var(--blue); color: white; }
        .paciente-item .dni-small { font-size: 0.75rem; opacity: 0.8; }

        /* Historial */
        .sesion-card { background: #fff; border-left: 5px solid var(--blue); padding: 15px; margin-bottom: 15px; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .sesion-header { display: flex; justify-content: space-between; font-size: 0.85rem; color: #95a5a6; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div id="login-screen">
        <h1>游댏 Acceso Privado</h1>
        <input type="password" id="passInput" placeholder="Contrase침a">
        <button class="btn-save" onclick="checkPass()">Entrar</button>
        <p id="error-msg" style="color:red; font-size: 0.8rem; margin-top: 10px; display: none;">Contrase침a incorrecta</p>
    </div>

    <div id="main-app">
        <div class="panel">
            <button class="btn-logout" onclick="location.reload()">Cerrar Sesi칩n</button>
            <h2>游닇 Nuevo Registro</h2>
            
            <label>DNI del Paciente:</label>
            <input type="text" id="dni" placeholder="Documento de identidad">
            
            <label>Nombre Completo:</label>
            <input type="text" id="paciente" placeholder="Nombre y Apellidos">
            
            <label>Tratamientos R치pidos:</label>
            <div class="quick-notes">
                <div class="btn-tag" onclick="addNote('CHC')">CHC</div>
                <div class="btn-tag" onclick="addNote('CF')">CF</div>
                <div class="btn-tag" onclick="addNote('TENS')">TENS</div>
                <div class="btn-tag" onclick="addNote('IF')">IF</div>
                <div class="btn-tag" onclick="addNote('KOTZ')">KOTZ</div>
                <div class="btn-tag" onclick="addNote('MG')">MG</div>
                <div class="btn-tag" onclick="addNote('TC')">TC</div>
                <div class="btn-tag" onclick="addNote('KINESIO')">KINESIO</div>
                <div class="btn-tag long" onclick="addNote('Liberaci칩n de tejidos blandos')">Lib. Tejidos Blandos</div>
                <div class="btn-tag long" onclick="addNote('Liberaci칩n de cicatriz')">Lib. Cicatriz</div>
            </div>
            
            <textarea id="notas" rows="4" placeholder="Notas adicionales de la sesi칩n..."></textarea>
            <button class="btn-save" onclick="agregarSesion()">GUARDAR SESI칍N</button>

            <h2 style="margin-top: 30px;">游논 Mis Pacientes</h2>
            <div id="listaPacientes"></div>
        </div>

        <div class="panel">
            <h2 id="tituloHistorial">Ficha Cl칤nica</h2>
            <div id="contenedorHistorial">
                <p style="text-align: center; color: #bdc3c7; margin-top: 50px;">Seleccione un paciente para ver su historial.</p>
            </div>
        </div>
    </div>

<script>
    const CLAVE_CORRECTA = "1234"; // <--- CAMBIA TU CLAVE AQU칈
    let pacienteSeleccionado = null;

    function checkPass() {
        const input = document.getElementById('passInput').value;
        if (input === CLAVE_CORRECTA) {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-app').style.display = 'grid';
            document.body.style.alignItems = 'start';
            actualizarInterfaz();
        } else {
            document.getElementById('error-msg').style.display = 'block';
        }
    }

    function addNote(text) {
        const area = document.getElementById('notas');
        area.value += (area.value ? ', ' : '') + text;
        area.focus();
    }

    function agregarSesion() {
        const dni = document.getElementById('dni').value.trim();
        const nombre = document.getElementById('paciente').value.trim();
        const notas = document.getElementById('notas').value.trim();
        
        if (!dni || !nombre || !notas) return alert('Complete DNI, Nombre y Notas.');

        const ahora = new Date();
        const fechaAuto = ahora.toLocaleDateString() + ' ' + ahora.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

        const nuevaSesion = {
            id: Date.now(),
            dni: dni,
            paciente: nombre,
            fecha: fechaAuto,
            notas: notas
        };

        let sesiones = JSON.parse(localStorage.getItem('fisioterapia_privada')) || [];
        sesiones.push(nuevaSesion);
        localStorage.setItem('fisioterapia_privada', JSON.stringify(sesiones));

        document.getElementById('notas').value = '';
        actualizarInterfaz();
        verHistorial(dni);
    }

    function actualizarInterfaz() {
        const listaDiv = document.getElementById('listaPacientes');
        const sesiones = JSON.parse(localStorage.getItem('fisioterapia_privada')) || [];
        const mapaPacientes = {};
        sesiones.forEach(s => mapaPacientes[s.dni] = s.paciente);

        listaDiv.innerHTML = '';
        Object.keys(mapaPacientes).sort().forEach(dni => {
            const div = document.createElement('div');
            div.className = `paciente-item ${pacienteSeleccionado === dni ? 'active' : ''}`;
            div.onclick = () => verHistorial(dni);
            div.innerHTML = `<strong>${mapaPacientes[dni]}</strong><span class="dni-small">DNI: ${dni}</span>`;
            listaDiv.appendChild(div);
        });
    }

    function verHistorial(dni) {
        pacienteSeleccionado = dni;
        actualizarInterfaz();
        const contenedor = document.getElementById('contenedorHistorial');
        const sesiones = JSON.parse(localStorage.getItem('fisioterapia_privada')) || [];
        const filtradas = sesiones.filter(s => s.dni === dni).reverse();
        
        document.getElementById('tituloHistorial').innerHTML = `Historial: ${filtradas[0].paciente} (DNI: ${dni})`;
        contenedor.innerHTML = '';

        filtradas.forEach(s => {
            const card = document.createElement('div');
            card.className = 'sesion-card';
            card.innerHTML = `<div class="sesion-header">游늰 ${s.fecha} <button style="color:red; border:none; background:none; cursor:pointer" onclick="borrarSesion(${s.id}, '${s.dni}')">Eliminar</button></div><div style="white-space: pre-wrap;">${s.notas}</div>`;
            contenedor.appendChild(card);
        });
    }

    function borrarSesion(id, dni) {
        if(confirm('쮼liminar registro?')) {
            let sesiones = JSON.parse(localStorage.getItem('fisioterapia_privada'));
            sesiones = sesiones.filter(s => s.id !== id);
            localStorage.setItem('fisioterapia_privada', JSON.stringify(sesiones));
            if (!sesiones.some(s => s.dni === dni)) {
                pacienteSeleccionado = null;
                location.reload(); 
            } else {
                verHistorial(dni);
            }
        }
    }
</script>
</body>
</html>
